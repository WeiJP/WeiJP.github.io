<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  
    
      
    

    
  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic|Bungee:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta name="description" content="无聊的XX十之八九，而有趣的灵魂万里挑一">
<meta property="og:type" content="website">
<meta property="og:title" content="Wei&#39;Blog">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="Wei&#39;Blog">
<meta property="og:description" content="无聊的XX十之八九，而有趣的灵魂万里挑一">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Wei&#39;Blog">
<meta name="twitter:description" content="无聊的XX十之八九，而有趣的灵魂万里挑一">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/2/"/>





  <title>Wei'Blog</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Wei'Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/02/25/blogBST/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="WeiJP">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wei'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/25/blogBST/" itemprop="url">（转）动态图详解 二叉搜索树</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-02-25T19:43:39+08:00">
                2017-02-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/数据结构和算法/" itemprop="url" rel="index">
                    <span itemprop="name">数据结构和算法</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>刚看到的一篇特别不错的文章，非常生动形象，转载过来，顺便改一点原作者马虎的地方 = =！，原地址：<a href="https://lufficc.com/blog/binary-search-tree" target="_blank" rel="noopener">https://lufficc.com/blog/binary-search-tree</a></p>
<p>在计算机科学中，二叉搜索树（Binary Search Tree）（有时称为有序或排序的二叉树）是一种能存储特定数据类型的容器。二叉搜索树允许快速查找、添加或者删除某一个节点，并且它是动态的集合。<br>二叉搜索树按照关键字顺序地保存节点，因此查找和其他操作可以使用二叉搜索原理：当在树（或者寻找插入新节点的地方）中查找节点时，它从根节点遍历到叶节点，与每个节点的关键字进行比较，然后基于比较结果，决定继续在左子树或者右子树中进行搜索。平均而言，每次比较将跳过树的大约一半的元素，这使得每次查找，插入或删除一个节点所花费的时间与树的节点个数的对数成（树的高度）正比，比线性表的性能要好很多。</p>
<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>二叉搜索树是以一棵二叉树来组织，每个节点就是一个对象，包括key、卫星数据，除此之外还包括一些为了维持树结构所需要的信息：left、right、parent，分别指向左孩子、右孩子、父节点。其中如果孩子节点或者父节点不存在时，用NIL表示。根节点是树中唯一一个父节点为NIL的节点。</p>
<p>二叉搜索树具有以下性质：</p>
<p>如果节点的左子树不空，则左子树上所有结点的值均小于等于它的根结点的值；<br>如果节点的右子树不空，则右子树上所有结点的值均大于等于它的根结点的值；<br>任意节点的左、右子树也分别为二叉查找树；<br><img src="http://img.blog.csdn.net/20170225183922366?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMzY3OTg4Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>比如在上图中根节点的关键字为6，左子树有关键字2、4和5，均不大于6；右子树有关键字7和8，均不小于6。这个性质对树中的每个节点都成立，也就是说，二叉搜索树的定义是递归的。</p>
<p>在讨论二叉搜索树的操作之前，先看看二叉搜索树的遍历。二叉搜索树可以使用先序遍历（preorder tree walk）、中序遍历（inorder tree walk）和后序遍历（postorder tree walk）。这样命名的依据是根据输出关键字相对于左右子树的位置。以中序遍历为例，伪代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">INORDER-TREE-WALK(x)   </span><br><span class="line">    if x != nil  // 如果节点不为空   </span><br><span class="line">        INORDER-TREE-WALK(x.left)  // 首先递归地遍历左孩子，直到左孩子为空   </span><br><span class="line">        print x.key     // 输出当前节点（显然第一次运行到这里时，它是最小值，因为它是整棵树的最左节点）     </span><br><span class="line">        INORDER-TREE-WALK(x.right)  // 递归地遍历右孩子</span><br></pre></td></tr></table></figure>
<p>对于上图中的二叉搜索树，动态过程如下，这样输出结果为：2，4，5，6，7，8，即按照从小到大的顺序排列。因为输出时一直遍历左孩子，知道遇到第一个左孩子为空的节点，将它输出，然后出栈返回继续输出。<br><img src="http://img.blog.csdn.net/20170225184159342?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMzY3OTg4Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h2 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h2><p>二叉搜索树还应该可以完成MINIMUM，MAXIMUM，SUCCESSOR和PREDECESSOR操作，即求最小值，最大值，后继和前驱，并且这些操作都可以在o(lgn)的时间内完成。</p>
<p><strong>查找指定关键字</strong></p>
<p>TREE-SEARCH操作在二叉树中查找一个具有指定的关键字的节点，输入树的根节点指针和关键字k，如果存在，返回节点指针，否则，返回nil。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">TREE-SEARCH(x, k)   </span><br><span class="line">    if x == nil or k == x.key  //如不存在或者找到，直接返回   </span><br><span class="line">        return x   </span><br><span class="line">    if k &lt; x.key                    //如果小于当前节点，根据性质，在左子树中搜索   </span><br><span class="line">        return TREE-SEARCH(x.left, k)   </span><br><span class="line">    else                          //如果大于等于当前节点，根据性质，在右子树中搜索   </span><br><span class="line">        return TREE-SEARCH(x.right, k)</span><br></pre></td></tr></table></figure>
<p>比如查找关键字为5的节点，首先从根节点6开始，与5进行比较，因为5小于6，因此在节点6的左子树继续搜索。到达节点4时因为5大于4，所以在4节点的右子树搜索，这样就顺利找到了节点5，此时函数将返回指向节点5的指针。如果找不到目标节点，TREE-SEARCH函数将返回nil。整个搜索过程如下：<br><img src="http://img.blog.csdn.net/20170225184320606?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMzY3OTg4Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br><strong>最小/最大关键字</strong></p>
<p>通过从树根开始，沿着left孩子向下搜索，直到遇到nil，那么根据二叉搜索树的性质，如果节点x没有左子树，而x的右子树的关键字肯定都大于x.key，因此此时当前节点一定是整个树中的最小值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">TREE-MINIMUM(x)   </span><br><span class="line">    while x.left != nil  // 沿着左子树一直深入搜索下去，直到遇到左子树为空的节点，此时当前节点为最小值   </span><br><span class="line">        x = x.left   </span><br><span class="line">    return x</span><br></pre></td></tr></table></figure>
<p>同理，最大关键字的伪代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">TREE-MAXIMUM(x)   </span><br><span class="line">    while x.right != nil  // 沿着右子树一直深入搜索下去，直到遇到右子树为空的节点，此时当前节点为最大值   </span><br><span class="line">        x = x.right   </span><br><span class="line">    return x</span><br></pre></td></tr></table></figure>
<p>求取最大、最小关键字的时间复杂度仅为o(lgn)，即与树的高度成正比，因为查找过程自上而下形成一条线，线的最大长度为数的高度，如求取最小值的过程：<br><img src="http://img.blog.csdn.net/20170225184456140?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMzY3OTg4Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br><strong>前驱/后继</strong></p>
<p>给定二叉搜索树的一个节点，有事需要按照中序遍历的次序查找它的后继，如果所有的关键字互不相同，则一个节点x的后继一定是大于x.key的最小关键字。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">TREE-SUCCESSOR(x)   </span><br><span class="line">    if x.right != nil   //case 1:如果右子树不为空，则后继一定是右子树的最小值，即大于x的最小值（右子树的值都大于x节点）   </span><br><span class="line">        return TREE-MINIMUM(x.right)   </span><br><span class="line">    y = x.p    // case 2:右子树为空时   </span><br><span class="line">    while y != nil and x == y.right   </span><br><span class="line">        x = y   // 变量x代表节点原始x的祖先，如果找到x，它是父节点的左孩子，则循环终止   </span><br><span class="line">        y = y.p   // y 代表节点x的父节点，如果x是y的左孩子，循环终止，并且返回y   </span><br><span class="line">    return y</span><br></pre></td></tr></table></figure>
<p>1、对于第一种情况比较简单，如果x右子树不为空，那它的后继就是右子树的最左节点，对应伪代码case 1，例如下图寻找68的后继，即寻找68的右子树的最小节点72，同时它也是右子树的最左节点。<br><img src="http://img.blog.csdn.net/20170225184558453?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMzY3OTg4Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>2、第二种情况是x的右子树为空，注意x的后继始终是大于x的最小值（或者不存在），所以当x的右子树不存在时大于x的最小值在哪儿呢？我们只需要简单的从x开始沿树而上，找到第一个这样一个节点：它的父节点为空（即根节点）或者它的左孩子是x节点的祖先节点（不一定是直接祖先）。例如下图中为了寻找17的后继，沿着树上升，首先以此遇到了节点13，11，它们均不符合条件，因为它们不是父节点的左孩子。当遇到节点10时，此时x指向节点10，y指向节点19，并且节点10是节点19的左孩子，符合条件，所以返回节点y，它是节点x的后继。<br><img src="http://img.blog.csdn.net/20170225184619080?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMzY3OTg4Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>再举一个例子，下图为了找15的后继，仍然沿着树上升，直到遇到节点10（此时伪代码中的变量x指向节点10）：它是15的祖先，而且是左孩子。所以此时返回节点10的父节点19，即节点15的后继。<br><img src="http://img.blog.csdn.net/20170225184655469?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMzY3OTg4Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>一个二叉搜索树中除了最大节点外，都有后继。对于前驱节点，和后继节点原理一样，这里不再赘述。</p>
<p><strong>插入</strong></p>
<p>插入操作会引起二叉搜索树集合的动态变化，因此需要一定的修改来维持二叉搜索树。由于二叉搜索树的性质，即左孩子小于等于父节点，右孩子大于等于父节点，因此插入操作相对简单。</p>
<p>将一个节点插入到二叉搜索树中，需要调用TREE-INSERT，该过程以节点z作为输入，其中z.left = nil, z.right = nil, z.key = 将要插入数据的关键字：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">TREE-INSERT(T, z)   </span><br><span class="line">    y = nil   </span><br><span class="line">    x = T.root   </span><br><span class="line">    while x != nil //循环结束后，x一定为空，此时x即为节点z要插入的地方   </span><br><span class="line">        y = x    //在这里给y赋值，保证循环结束后y始终是x的父节点   </span><br><span class="line">        if z.key &lt; x.key   </span><br><span class="line">            x = x.left   </span><br><span class="line">        else   </span><br><span class="line">            x = x.right   </span><br><span class="line">        z.p = y  //  y始终是x的父节点，为了插入z，需要让z的父节点指向x的父节点，即指向y   </span><br><span class="line">        if y == nil  //  如果y为空，说明插入时是一棵空的树，需要将树根指向z   </span><br><span class="line">            T.root = z   </span><br><span class="line">        elseif z.key &lt; y.key   //  判断节点z是y的左孩子还是右孩子   </span><br><span class="line">            y.left = z   </span><br><span class="line">        else   </span><br><span class="line">            y.right = z</span><br></pre></td></tr></table></figure>
<p>上述伪代码从树根开始，指针x记录了一条向下的简单路径，通过while循环比较z.key和x.key的大小，使指针x和指针y向下移动，循环结束时则找到一个空的x并作为一个槽，将节点z放到这里（插入），同时保持节点y为节点x的父节点，这样可以很方便的决定插入之后将z作为它的左孩子还是右孩子。举一个例子：<br><img src="http://img.blog.csdn.net/20170225184801441?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMzY3OTg4Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>上图为了在树中插入节点46，首先x指向根节点，节点46与根节点68（x节点）比较，小于68，因此指针x指向根节点（x节点）的左孩子62，然后一直下移。注意当x指向45的时候，节点46大于45，因此将x指向节点45的右孩子，此时x为nil了，循环结束，也就找到了节点46的位置：节点45的右孩子。然后进行一些操作将节点46插入到树中即可。</p>
<p><strong>删除</strong></p>
<p>从二叉搜索树中删除一个节点z稍微有点棘手，但总的来说可以分为三种情况：</p>
<p>1、如果z没有孩子节点，那么简单的将它删除，并修改它的父节点，用nil作为孩子节点代替z即可。</p>
<p>2、如果z只有一个孩子，那么将这个孩子提升到z的位置，并修改它的父点，用z的孩子代替z即可。</p>
<p>3、如果z有两个孩子，那么用z的后继y（此时z的后继y一定在z的右子树中，因为z的右孩子不为空）来占据z的位置，此时z的原来的右子树部分称为y的新的右子树，并且z的左子树称为y的新的左子树。这种情况稍微麻烦，因为还与y是否为z的右孩子相关。</p>
<p><em>第一种情况：节点z没有孩子</em><br>这种情况比较简单，我们直接删除节点z即可，并不会影响到二叉搜索树的性质：<br><img src="http://img.blog.csdn.net/20170225185055460?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMzY3OTg4Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>用动图来表示就是：<br><img src="http://img.blog.csdn.net/20170225185108242?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMzY3OTg4Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p><em>第二种情况：节点z只有一个孩子</em></p>
<p>这种情况也比较简单，直接用节点z的孩子代替节点z即可。其实第一种情况和第二种情况可以归为一个：节点z的孩子个数小于2个，直接用节点z的孩子代替节点z即可，只是节点z没有孩子时是用的nil代替节点z，这里为了更加清楚地说明分了三种情况。<br><img src="http://img.blog.csdn.net/20170225185157899?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMzY3OTg4Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>例如如下图，当节点42只有左孩子时，直接将42的父节点6的右孩子指向节点29，将节点29的父节点设置为节点6即可：<br><img src="http://img.blog.csdn.net/20170225185255972?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMzY3OTg4Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>或者只有右孩子时也是如此，直接将94的左孩子指向78，78的父节点指向94即可：<br><img src="http://img.blog.csdn.net/20170225185320379?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMzY3OTg4Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p><em>第三种情况：节点z有两个孩子</em></p>
<p>这种情况稍微复杂一点，因为此时我们需要找到节点z的后继y，而后继节点y又分为y是节点z的直接右孩子或者不是。</p>
<p>1、z的后继y是 z的右孩子</p>
<p>此时可以直接用后继y代替z，而且y的左孩子此时一定为空（因为后继的左孩子一定为空），再用z的左孩子代替y的原来为空的左孩子即可。<br><img src="http://img.blog.csdn.net/20170225185625203?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMzY3OTg4Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>用动图表示删除节点67就是：<br><img src="http://img.blog.csdn.net/20170225185825705?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMzY3OTg4Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>2、z的后继y不是 z的右孩子</p>
<p>在这种情况下我们先用y的右孩子x代替y，然后再用y代替z:<br><img src="http://img.blog.csdn.net/20170225190044007?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMzY3OTg4Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>用动图表示删除节点50就是用74代替73，即将73的父节点82的右孩子指向74,74的父节点设置为82，然后再用73代替50，即将50左孩子31设置为73的左孩子，50的右孩子82设置为73的右孩子：<br><img src="http://img.blog.csdn.net/20170225190135209?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMzY3OTg4Mg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>为了实现删除过程的伪代码，我们需要定义一个子过程TRANSPLANT，它是用为了用以v为根的子树替换以u为根的子树，让u的双亲节点变为v的双亲节点，即让v称为u的双亲节点的孩子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">TRANSPLANT(T, u, v)   </span><br><span class="line">    if u.p == nil   // 当u位树的根节点时，直接将树的根节点指向v   </span><br><span class="line">        T.root = v   </span><br><span class="line">    elseif u == u.p.left   // 如果u是左孩子，则u的父节点的左孩子指向v   </span><br><span class="line">        u.p.left = v   </span><br><span class="line">    else    // 如果u是右孩子，则u的父节点的右孩子指向v   </span><br><span class="line">        u.p.right = v   </span><br><span class="line">    if v != nil      </span><br><span class="line">        v.p = u.p    // 将v的父节点设为u的父节点</span><br></pre></td></tr></table></figure>
<p>然后实现具体的删除过程：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">TREE-DELETE(T, z)   </span><br><span class="line">    if z.left == nil  // 如果左孩子为空，则直接用右孩子代替z即可，而不管右孩子是否为空（右孩子为空时对应情况一否则对应情况二）   </span><br><span class="line">        TRANSPLANT(T, z, z.right)   </span><br><span class="line">    elseif z.right == nil  // 右孩子为空，直接用做孩子代替z   </span><br><span class="line">        TRANSPLANT(T, z, z.left)   </span><br><span class="line">    else y = TREE-MINIMUM(z.right)  // 左右孩子均不为空，找到z的后继y，即z的右子树的最小值，对应第三种情况   </span><br><span class="line">        if y.p != z   // 如果z的后继y不是z的右孩子，对应第三种情况的2   </span><br><span class="line">            TRANSPLANT(T, y, y.right)  // 用y的右孩子代替y   </span><br><span class="line">            y.right = z.right    // 将y的右孩子指向z的右孩子   </span><br><span class="line">            y.right.p = y     // 将y的右孩子(原来的z的右孩子)的父节点设为y   </span><br><span class="line">        TRANSPLANT(T, z, y)  // 用y代替z   </span><br><span class="line">        y.left = z.left   </span><br><span class="line">        y.left.p = y</span><br></pre></td></tr></table></figure>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>因为二叉搜索树的性质，即可以在每个比较之后将数据规模变为原来的一半，因此平均情况下每一个操作都可以在o(lgn)的时间内完成，即花费时间与树的高度成正比。但在最坏的情况下，二叉搜索树就退化为一个链表，此时的时间复杂度退化到了o(n)。但很多改进版的二叉查找树可以使树高为o(lgn)，如SBT，AVL树，红黑树等。</p>
<p>参考文献</p>
<p>1、算法导论<br>2、维基百科<br>3、visualgo</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/11/29/blogLocalNotification/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="WeiJP">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wei'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/11/29/blogLocalNotification/" itemprop="url">关于iOS 9之前的本地推送，本地推送杀掉进程后到底能不能收到？</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-11-29T11:49:01+08:00">
                2016-11-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS相关/" itemprop="url" rel="index">
                    <span itemprop="name">iOS相关</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="缘起一个面试："><a href="#缘起一个面试：" class="headerlink" title="缘起一个面试："></a>缘起一个面试：</h2><p><strong>面试官</strong>:“本地推送，在杀掉进程以后还可以收到吗？”<br><strong>我</strong>（非常肯定的）:“可以的”<br><strong>面试官</strong>：“并不能，不信你回去写个demo吧”<br><strong>我</strong>：“我写过本地推送，确实是可以的啊”<br><strong>面试官</strong>：“如果杀掉进程后，还能收到本地推送，那还要远程推送干什么呢？？？”<br><strong>我</strong>：“。。。。。。”</p>
<p>本来无意来计较这件事，但是面试过程中，面试官态度比较强硬、瞧不起人，让人很反感，但还是不说哪家公司了</p>
<p><img src="http://img.blog.csdn.net/20161129104433799" alt="这个结果根本不意外吧，稍微做过一两年开发的都知道"></p>
<p><strong>今天我就写一个Demo，然后再唠叨原理</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">// 以下代码只为简单的验证问题，不是教程，诸位凑合看吧</span><br><span class="line">// 注册通知</span><br><span class="line">+ (void)registerPush</span><br><span class="line">&#123;</span><br><span class="line">    UILocalNotification *localNotification = [[UILocalNotification alloc] init];</span><br><span class="line">    </span><br><span class="line">    localNotification.fireDate = [NSDate dateWithTimeIntervalSinceNow:15];</span><br><span class="line">    localNotification.alertBody = @&quot;I am a LocalNotification!&quot;;</span><br><span class="line">    localNotification.alertAction = @&quot;check&quot;;</span><br><span class="line">    localNotification.hasAction = YES;</span><br><span class="line">    localNotification.applicationIconBadgeNumber = 1;</span><br><span class="line">    </span><br><span class="line">    [[UIApplication sharedApplication] scheduleLocalNotification:localNotification];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> *   iOS 8 以后的版本需要添加推送类型</span><br><span class="line"> *   官方文档：In iOS 8.0 and later, your application must register for user notifications using -[UIApplication registerUserNotificationSettings:] before being able to schedule and present UILocalNotifications</span><br><span class="line"> */</span><br><span class="line">+ (void)registerPushType</span><br><span class="line">&#123;</span><br><span class="line">    if (NSFoundationVersionNumber &gt;= NSFoundationVersionNumber_iOS_8_0) &#123;</span><br><span class="line">        UIUserNotificationType type=UIUserNotificationTypeBadge | UIUserNotificationTypeAlert | UIUserNotificationTypeSound;</span><br><span class="line">        UIUserNotificationSettings *setting=[UIUserNotificationSettings settingsForTypes:type categories:nil];</span><br><span class="line">        [[UIApplication sharedApplication]registerUserNotificationSettings:setting];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 清除角标</span><br><span class="line">+ (void)clearIconBadgeNumber</span><br><span class="line">&#123;</span><br><span class="line">    [UIApplication sharedApplication].applicationIconBadgeNumber = 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="本地推送的机制"><a href="#本地推送的机制" class="headerlink" title="本地推送的机制"></a>本地推送的机制</h2><p>看官方文档<a href="https://developer.apple.com/reference/uikit/uilocalnotification?language=objc" target="_blank" rel="noopener">点击这里</a>，第一句话是：<br>The operating system is responsible for delivering local notifications at their scheduled times; the app does not have to be running for this to happen.Although local notifications are similar to remote notifications in that they are used for displaying alerts, playing sounds, and badging app icons, they are composed and delivered locally and do not require connection with remote servers.<br>明确说明了本地推送是由操作系统负责触发的，不需要App本身，后边还特别注明了尽管与远程推送一样的效果，但是不需要与远程服务器链接。      </p>
<p><strong>也就是说，无论有无网络连接，App进程是否被杀掉，都可以接收到本地推送。</strong></p>
<p>管理（or触发?）本地推送的两个方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- (void)presentLocalNotificationNow:(UILocalNotification *)notification;</span><br><span class="line"></span><br><span class="line">- (void)scheduleLocalNotification:(UILocalNotification *)notification;  // copies notification</span><br></pre></td></tr></table></figure>
<p>第一个，直接触发，平时我用的很少。<br>第二个，把本地通知交给操作系统，操作系统根据通知内包含的信息决定何时何地推送这条本地推送。（附：本地推送会被系统拷贝一份副本，便于触发后的释放）</p>
<p><em>写在最后，做技术的还是少装13，我不知道这位面试官为何会万分肯定在进程被杀掉之后是收不到本地推送的，难道连文档都不看就出来教育别人了么？？？</em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/11/17/blogCGRectInsetOffset/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="WeiJP">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wei'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/11/17/blogCGRectInsetOffset/" itemprop="url">关于CGRectInset和CGRectOffset简单说明</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-11-17T12:51:57+08:00">
                2016-11-17
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS相关/" itemprop="url" rel="index">
                    <span itemprop="name">iOS相关</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>首先确定这两个方法都是对CGRect类型的变量进行操作的，写iOS动画代码时经常用到。</p>
<h2 id="1-CGRectInset"><a href="#1-CGRectInset" class="headerlink" title="1.  CGRectInset"></a>1.  CGRectInset</h2><p>不多说，上代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// center 为 (200, 200), 由(100+200/2, 100+200/2)得</span><br><span class="line">CGRect originalRect = CGRectMake(100, 100, 200, 200);</span><br><span class="line">    </span><br><span class="line">CGRect rect_Inset1 = CGRectInset(originalRect, 10, 10);</span><br><span class="line">CGRect rect_Inset2 = CGRectInset(originalRect, -10, -10);</span><br><span class="line"></span><br><span class="line">NSLog(@&quot;原始矩形大小:%@&quot;, NSStringFromCGRect(originalRect));</span><br><span class="line">NSLog(@&quot;dx=10, dy=10, CGRectInset:%@&quot;, NSStringFromCGRect(rect_Inset1));</span><br><span class="line">NSLog(@&quot;dx=-10, dy=-10, CGRectInset:%@&quot;, NSStringFromCGRect(rect_Inset2));</span><br></pre></td></tr></table></figure>
<p>结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">原始矩形大小:&#123;&#123;100, 100&#125;, &#123;200, 200&#125;&#125;</span><br><span class="line">dx=10, dy=10, CGRectInset:&#123;&#123;110, 110&#125;, &#123;180, 180&#125;&#125;</span><br><span class="line">dx=-10, dy=-10, CGRectInset:&#123;&#123;90, 90&#125;, &#123;220, 220&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>根据结果得知：</p>
<ol>
<li>原始矩形center不变，始终是(200, 200)；</li>
<li>原始矩形size变化，width = width-2<em>dx， height = height-2</em>dy;<br><strong>图解：</strong><br><img src="http://img.blog.csdn.net/20161117113924473" alt="这里写图片描述"><br><strong>官方文档：</strong><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/* Inset `rect&apos; by `(dx, dy)&apos; -- i.e., offset its origin by `(dx, dy)&apos;, and</span><br><span class="line">   decrease its size by `(2*dx, 2*dy)&apos;. */</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="2-CGRectOffset"><a href="#2-CGRectOffset" class="headerlink" title="2.  CGRectOffset"></a>2.  CGRectOffset</h2><p>还是上代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CGRect originalRect = CGRectMake(100, 100, 200, 200);</span><br><span class="line"></span><br><span class="line">CGRect rect_Offset1 = CGRectOffset(originalRect, 10, 10);</span><br><span class="line">CGRect rect_Offset2 = CGRectOffset(originalRect, -10, -10);</span><br><span class="line"></span><br><span class="line">NSLog(@&quot;原始矩形大小:%@&quot;, NSStringFromCGRect(originalRect));</span><br><span class="line">NSLog(@&quot;dx=10, dy=10, CGRectOffset:%@&quot;, NSStringFromCGRect(rect_Offset1));</span><br><span class="line">NSLog(@&quot;dx=-10, dy=-10, CGRectOffset:%@&quot;, NSStringFromCGRect(rect_Offset2));</span><br></pre></td></tr></table></figure>
<p>结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">原始矩形大小:&#123;&#123;100, 100&#125;, &#123;200, 200&#125;&#125;</span><br><span class="line">dx=10, dy=10, CGRectOffset:&#123;&#123;110, 110&#125;, &#123;200, 200&#125;&#125;</span><br><span class="line">dx=-10, dy=-10, CGRectOffset:&#123;&#123;90, 90&#125;, &#123;200, 200&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>根据结果得知：</p>
<ol>
<li>原始矩形size不变，始终是 (200, 200);</li>
<li>原始矩形center改变，x = x+dx, y = y+dy;<br><strong>图解：</strong><br><img src="http://img.blog.csdn.net/20161117125058657" alt="这里写图片描述"><br><strong>官方文档：</strong></li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/* Offset `rect&apos; by `(dx, dy)&apos;. */</span><br></pre></td></tr></table></figure>
<p><em>以上若有错误或不足，欢迎指正，感谢</em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/10/31/blogPython161031/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="WeiJP">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wei'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/10/31/blogPython161031/" itemprop="url">Python的装饰器和with语法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-10-31T14:01:17+08:00">
                2016-10-31
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python相关/" itemprop="url" rel="index">
                    <span itemprop="name">Python相关</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;python 2.7&gt;</span><br><span class="line">本文分两部分，第一部分是装饰器，第二部分是with语法，</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@with_connection</span><br><span class="line">def do_some_db_operation():</span><br><span class="line">    db.select(&apos;...&apos;)</span><br><span class="line">    db.update(&apos;...&apos;)</span><br><span class="line">    db.update(&apos;...&apos;)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">with db.connection():</span><br><span class="line">    db.select(&apos;...&apos;)</span><br><span class="line">    db.update(&apos;...&apos;)</span><br><span class="line">    db.update(&apos;...&apos;)</span><br></pre></td></tr></table></figure>
<p>上下两个代码片的作用是一样的，关于数据库操作的，都使用了with语法，只不过上边的使用了装饰器，更加方便了。</p>
<h2 id="lt-装饰器-gt"><a href="#lt-装饰器-gt" class="headerlink" title="&lt;装饰器&gt;"></a>&lt;装饰器&gt;</h2><p>动态增加代码功能，定义一个who的装饰器：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import functools</span><br><span class="line"></span><br><span class="line">def who(func):</span><br><span class="line">	@functools.wraps(func)</span><br><span class="line">    def wrapper(*args, **kw):</span><br><span class="line">        增加的功能&apos;x&apos;代码，比如 print &apos;&lt;我是小菜&gt;&apos;</span><br><span class="line">        return func(*args, **kw)</span><br><span class="line">    return wrapper</span><br></pre></td></tr></table></figure>
<p>使用时：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@who</span><br><span class="line">def beatDoudou():</span><br><span class="line">    print &apos;打豆豆&apos;</span><br></pre></td></tr></table></figure>
<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;我是小菜&gt;</span><br><span class="line">打豆豆</span><br></pre></td></tr></table></figure>
<p>关于<code>@functools.wraps(fund)</code>的作用是：<br>因为在原函数外加了一层wrapper，所以调用<code>beatDoudou.__name__</code>时，返回的是wrapper，并不是beatDoudou，避免有些依赖函数签名的代码执行出错。<br><strong>带参数的装饰器</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import functools</span><br><span class="line"></span><br><span class="line">def who(name):</span><br><span class="line">    def decorator(func):</span><br><span class="line">        @functools.wraps(func)</span><br><span class="line">        def wrapper(*args, **kw):</span><br><span class="line">            print &apos;&lt;我是%s&gt;&apos; % name</span><br><span class="line">            return func(*args, **kw)</span><br><span class="line">        return wrapper</span><br><span class="line">    return decorator</span><br></pre></td></tr></table></figure>
<p>使用时：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@who</span><br><span class="line">def beatDoudou(&apos;大鸟&apos;):</span><br><span class="line">    print &apos;打豆豆&apos;</span><br></pre></td></tr></table></figure>
<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;我是大鸟&gt;</span><br><span class="line">打豆豆</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;with 语法&gt;</span><br><span class="line">---------</span><br><span class="line"></span><br><span class="line">使用with语法，首先要有上下文管理器（class），这个上下文管理器遵守上下文管理协议，即实现了__enter__() 和 __exit__() 方法，比如（代码看看格式就好）：</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">class _ConnectionCtx(object):</span><br><span class="line">	&quot;&quot;&quot;</span><br><span class="line">	with connection():</span><br><span class="line">		pass</span><br><span class="line">		with connection():</span><br><span class="line">			pass</span><br><span class="line">	&quot;&quot;&quot;</span><br><span class="line">	def __enter__(self):</span><br><span class="line">		&quot;&quot;&quot;</span><br><span class="line">		获得一个惰性连接对象</span><br><span class="line">		&quot;&quot;&quot;</span><br><span class="line">		global _db_ctx</span><br><span class="line">		self.should_cleanup = False</span><br><span class="line">		if not _db_ctx.is_init():</span><br><span class="line">			_db_ctx.init()</span><br><span class="line">			self.should_cleanup = True</span><br><span class="line">		return self</span><br><span class="line">	def __exit__(self, exctype, excvalue, traceback):</span><br><span class="line">		&quot;&quot;&quot;</span><br><span class="line">		释放连接对象</span><br><span class="line">		&quot;&quot;&quot;</span><br><span class="line">		global _db_ctx</span><br><span class="line">		if self.should_cleanup:</span><br><span class="line">			_db_ctx.cleanup()</span><br><span class="line">#with _ConnectionCtx():关键句</span><br><span class="line">def with_connection(func):</span><br><span class="line">	&quot;&quot;&quot;</span><br><span class="line">	设计一个装饰器，替换with语法，让代码更优雅</span><br><span class="line">	比如:</span><br><span class="line">        @with_connection</span><br><span class="line">        def foo(*args, **kw):</span><br><span class="line">            f1()</span><br><span class="line">            f2()</span><br><span class="line">            f3()</span><br><span class="line">	&quot;&quot;&quot;</span><br><span class="line">	@functools.wraps(func)</span><br><span class="line">	def _wrapper(*args, **kw):</span><br><span class="line">		with _ConnectionCtx():</span><br><span class="line">			return func(*args, **kw)</span><br><span class="line">	return _wrapper</span><br></pre></td></tr></table></figure>
<p><strong>with语法作用</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">with db.connection():</span><br><span class="line">    db.select(&apos;...&apos;)</span><br><span class="line">    db.update(&apos;...&apos;)</span><br><span class="line">    db.update(&apos;...&apos;)</span><br></pre></td></tr></table></figure></p>
<p>三个数据库操作成为语句块，在执行之前，先执行上下文管理器的<strong>enter</strong>函数，即获得数据库连接；在执行完语句块之后，再执行<strong>exit</strong>函数，即释放数据库连接。</p>
<p><strong>with语句执行过程类似如下：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">以下代码来自[这里](https://www.ibm.com/developerworks/cn/opensource/os-cn-pythonwith/)</span><br><span class="line">context_manager = context_expression</span><br><span class="line">    exit = type(context_manager).__exit__  </span><br><span class="line">    value = type(context_manager).__enter__(context_manager)</span><br><span class="line">    exc = True   # True 表示正常执行，即便有异常也忽略；False 表示重新抛出异常，需要对异常进行处理</span><br><span class="line">    try:</span><br><span class="line">        try:</span><br><span class="line">            target = value  # 如果使用了 as 子句</span><br><span class="line">            with-body     # 执行 with-body</span><br><span class="line">        except:</span><br><span class="line">            # 执行过程中有异常发生</span><br><span class="line">            exc = False</span><br><span class="line">            # 如果 __exit__ 返回 True，则异常被忽略；如果返回 False，则重新抛出异常</span><br><span class="line">            # 由外层代码对异常进行处理</span><br><span class="line">            if not exit(context_manager, *sys.exc_info()):</span><br><span class="line">                raise</span><br><span class="line">    finally:</span><br><span class="line">        # 正常退出，或者通过 statement-body 中的 break/continue/return 语句退出</span><br><span class="line">        # 或者忽略异常退出</span><br><span class="line">        if exc:</span><br><span class="line">            exit(context_manager, None, None, None) </span><br><span class="line">        # 缺省返回 None，None 在布尔上下文中看做是 False</span><br></pre></td></tr></table></figure>
<p>ps：markdown编辑器有bug吧，有些内容显示不出来，只好改成代码片才可以，所以排版有点乱，sorry</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/10/25/blognotemysqlutf8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="WeiJP">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wei'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/10/25/blognotemysqlutf8/" itemprop="url">Mac OS X下，MySQL在/etc/下没有my.cnf（MySQL修改编码时发现的问题）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-10-25T11:09:16+08:00">
                2016-10-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/笔记/" itemprop="url" rel="index">
                    <span itemprop="name">笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>一般安装完MySQL后都要修改编码方式为utf8</p>
<p>MySQL版本：5.7.16<br>OS版本：OS X EI Capitan（ 10.11.5 ）</p>
<p>设置编码时需要修改/etc/my.cnf的内容，但是在/etc/下并没有my.cnf，<br>但是，<br>在/usr/local/mysql/support-files下有一个my-default.cnf，只要把这个文件复制到/etc/下，再改名就好了</p>
<p>顺便说一下修改的步骤：</p>
<ol>
<li>我修改的并不是utf8，而是utf8mb4，区别请自行查询</li>
<li>先登录到mysql：<br> mysql -u 数据库帐号 -p</li>
<li>查看默认安装的字符集：<br> mysql&gt; show variables like ‘%char%’; <em>（分号属于命令行）</em></li>
<li>使用775权限：<br> sudo chmod 775 /etc/my.cnf</li>
<li>使用vim打开my.cnf，编辑：<br> vi /etc/my.cnf</li>
<li><p>在[mysqld]上边添加</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[client]  </span><br><span class="line">default-character-set=utf8</span><br></pre></td></tr></table></figure>
</li>
<li><p>在[mysqld]下边添加：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">character-set-server=utf8</span><br></pre></td></tr></table></figure>
</li>
<li><p>键入:wq保存并退出，再次进入查看，看到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">character_set_database   | utf8</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>就是修改成功了</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/10/25/blognotemysqlconnect/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="WeiJP">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wei'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/10/25/blognotemysqlconnect/" itemprop="url">Can't connect to local MySQL server through socket '/tmp/mysql.sock'</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-10-25T10:47:21+08:00">
                2016-10-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/笔记/" itemprop="url" rel="index">
                    <span itemprop="name">笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>相关提示：</p>
<ol>
<li>The server quit without updating PID file</li>
<li>Can’t connect to local MySQL server through socket ‘/tmp/mysql.sock’</li>
<li>在‘系统偏好设置’里无法启动MySQL</li>
</ol>
<p>解决方法：</p>
<ol>
<li><p>sudo rm /usr/local/mysql </p>
</li>
<li><p>sudo rm -rf /usr/local/mysql*  </p>
</li>
</ol>
<p>3  sudo rm -rf /Library/StartupItems/MySQLCOM （可选）</p>
<p>4  sudo rm -rf /Library/PreferencePanes/My*   （可选） </p>
<p>5  vim /etc/hostconfig  (and removed the line MYSQLCOM=-YES-)  （ 可选）  </p>
<p>6  rm -rf ~/Library/PreferencePanes/My*</p>
<p>7  sudo rm -rf /Library/Receipts/mysql*</p>
<p>8  sudo rm -rf /Library/Receipts/MySQL*</p>
<p>9  sudo rm -rf /var/db/receipts/com.mysql.*</p>
<p>再重新安装 MySQL,  顺利启动。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/09/09/blogPythonDocx/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="WeiJP">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wei'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/09/09/blogPythonDocx/" itemprop="url">如何把网页上的图片写入到docx文档</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-09-09T18:30:33+08:00">
                2016-09-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python相关/" itemprop="url" rel="index">
                    <span itemprop="name">Python相关</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>主要是用的是python-docx，安装sudo pip install python-docx，<br>官方文档：<a href="http://python-docx.readthedocs.org/en/latest/" target="_blank" rel="noopener">http://python-docx.readthedocs.org/en/latest/</a></p>
<p>要将链接对应的图片先下载到内存中，然后使用add_picture方法写入docx文档，具体代码如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">import StringIO</span><br><span class="line">from PIL import Image</span><br><span class="line">from docx.shared import Inches</span><br><span class="line"></span><br><span class="line">request = urllib2.Request(imageUrl])</span><br><span class="line">imageData = urllib2.urlopen(request).read()</span><br><span class="line">image_io = StringIO.StringIO()</span><br><span class="line">image_io.write(imageData)</span><br><span class="line">image_io.seek(0)</span><br><span class="line">im = Image.open(image_io)#通过im.size可以获取图片的尺寸，此处我没有用到</span><br><span class="line">doc_new.add_picture(image_io, width=Inches(6))</span><br></pre></td></tr></table></figure>
<p>6英寸的宽度正好是docx文档内容的宽度<br>刚接触python，好神奇</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/02/23/blogALAssetPropertyAssetURL/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="WeiJP">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wei'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/02/23/blogALAssetPropertyAssetURL/" itemprop="url">关于ALAsset的ALAssetPropertyAssetURL如何获取图片</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-02-23T18:35:01+08:00">
                2016-02-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS相关/" itemprop="url" rel="index">
                    <span itemprop="name">iOS相关</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>I want to get the name of the image picked from the library or newly clicked in -</p>
<pre><code>-(void) imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info
</code></pre><p>I am using this code:</p>
<pre><code>-(void) imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info
{
    if ([UIImagePickerController isSourceTypeAvailable: UIImagePickerControllerSourceTypeSavedPhotosAlbum])
    {
        AppDelegate *del = [[UIApplication sharedApplication]delegate];
        [self dismissModalViewControllerAnimated:YES];
        image = [info objectForKey:UIImagePickerControllerOriginalImage];

        NSLog(@&quot;imagekbgfg=====&gt;%@&quot;,image);
        [self.imageView setImage:image];

        imgName = [info objectForKey:UIImagePickerControllerOriginalImage];

        del.mainImgName = imgName;
        del.imageData = UIImageJPEGRepresentation(image, 1.0);
        del.imageApp = image;
    }

    if ([UIImagePickerController isSourceTypeAvailable: UIImagePickerControllerSourceTypeCamera])
    {
       image = [info objectForKey:UIImagePickerControllerOriginalImage];
    }
}
</code></pre><p>How can I do this?</p>
<p>——————————————————————————</p>
<p>Using the code bellow you will get path like:assets-library://asset/asset.JPG?id=79450962-C0FD-484C-808B-83E045F40972&amp;ext=JPG when your picking image from photo album. This path is valid. It contains the asset ID and asset type.</p>
<pre><code>// Firstly get the picked image&apos;s file URL.
NSURL *imageFileURL = [info objectForKey:UIImagePickerControllerReferenceURL];

// Then get the file name.
NSString *imageName = [imageFileURL lastPathComponent];
NSLog(@&quot;image name is %@&quot;, imageName);
If you want to get image user picked again using the path you get using UIImagePickerController.(Here maybe you want to save the path so that you can read that image back without asking user to pick that image again) You will need the ALAssetsLibrary otherwise you don&apos;t need it.

ALAssetsLibrary *library = [[ALAssetsLibrary alloc] init];
__block UIImage *returnValue = nil;
[library assetForURL:imageFileURL resultBlock:^(ALAsset *asset) {
    returnValue = [UIImage imageWithCGImage:[[asset defaultRepresentation] fullResolutionImage]];
} failureBlock:^(NSError *error) {
    NSLog(@&quot;error : %@&quot;, error);
}];
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/01/04/blog160104/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="WeiJP">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wei'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/01/04/blog160104/" itemprop="url">《笔记》自定义UITableView的headerView设置背景色无效的解决方案</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-01-04T16:21:26+08:00">
                2016-01-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS相关/" itemprop="url" rel="index">
                    <span itemprop="name">iOS相关</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>自定义headerView设置背景色无效，提示：</p>
<p><em>Changing the background color on a UITableViewHeaderFooterView loaded from a xib says to use contentView.backgroundColor instead</em></p>
<p>但是调用 contentView.background也无效，因为自定义的headerView并没有这个contentView，也就是说<strong>contentView = nil</strong>。</p>
<p>解决方法就是在自定义headerView的最下层，放一个bgView充当背景色，或者放一张图片在最下边。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/11/03/blogStoryBoardReferences/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="WeiJP">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wei'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/11/03/blogStoryBoardReferences/" itemprop="url">关于iOS 9里 Storyboard References出现的问题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-11-03T18:01:59+08:00">
                2015-11-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS相关/" itemprop="url" rel="index">
                    <span itemprop="name">iOS相关</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Storyboard References 是iOS 9 新增的功能，如图:<br><img src="http://img.blog.csdn.net/20151103180808269?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p>很实用的一个功能，简化storyboard，看起来清爽一些，如图:</p>
<p><img src="http://img.blog.csdn.net/20151103180852994?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p>但是，一定要注意一件事，编译的Deployment Target 设置为9.0或以上，否则会报如下错误</p>
<p>Storyboard References cannot be the destinations of relationship segues prior to iOS 9.0</p>
<p>ps: 我放弃使用了</p>
<p><em>以上若有错误，欢迎提出意见，感谢</em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="WeiJP" />
          <p class="site-author-name" itemprop="name">WeiJP</p>
           
              <p class="site-description motion-element" itemprop="description">无聊的XX十之八九，而有趣的灵魂万里挑一</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">25</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">8</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">26</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/WeiJP" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                    
                      GitHub
                    
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://weijinpeng2012@gmail.com" target="_blank" title="E-Mail">
                  
                    <i class="fa fa-fw fa-envelope"></i>
                  
                    
                      E-Mail
                    
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://blog.csdn.net/u013679882" target="_blank" title="CSDN">
                  
                    <i class="fa fa-fw fa-link"></i>
                  
                    
                      CSDN
                    
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">WeiJP</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  



  
  









  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>

  
  <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>

  
  <script type="text/javascript" src="/lib/three/three.min.js"></script>

  
  <script type="text/javascript" src="/lib/three/three-waves.min.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.2"></script>



  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  





  

  

  

  

  

  

</body>
</html>
